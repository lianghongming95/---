{"pages":[{"pageinfo":{"marktype":"2","status":"1","clientcategorycode":"2","pagetemplatecode":"201","type":"62","code":"1258567453622014034","cache":{"enable":"1","keys":["id"]},"title":"铺市检查","pagedescr":"终端拜访铺市检查","directorytypecode":"1099863944148947043","versionnum":"2.0","eventlist":[{"trigger":"onload","handler":""}],"pagecode":"1258567453622014034"},"view":{"body":{"type":"layout","code":"layout-4648563854039516","eventlist":[],"display":"flex","flexdirection":"vertical","flex":"1","bordersides":"","content":[{"type":"textinput","code":"textinput-9214135724336418","eventlist":[],"name":"storeid","titlewidth":"","titleflex":"20%","title":"终端ID","placeholder":"","verificationrule":"","hidden":"1","flex":"0"},{"type":"layout","code":"layout-4134635004360676","eventlist":[],"display":"flex","flexdirection":"vertical","flex":"","content":[{"type":"layout","code":"layout-9656859096910010","eventlist":[],"display":"flex","flexdirection":"horizontal","flex":"","bordersides":"","content":[{"type":"dropdownbox","code":"dropdownbox-7594583300503574","eventlist":[{"trigger":"onload","handler":"1126440265700216928"},{"trigger":"onvaluechange","handler":"1255742610920837213"}],"name":"品牌","titlewidth":"","titleflex":"20%","title":"","placeholder":"品牌","hiddenclearbtn":"0","flex":"1"},{"type":"dropdownbox","code":"dropdownbox-4607433631252034","eventlist":[{"trigger":"onload","handler":"1126440265700216926"},{"trigger":"onvaluechange","handler":"1255742610920837213"}],"name":"品类","titlewidth":"","titleflex":"20%","title":"","placeholder":"品类","hiddenclearbtn":"0","flex":"1"},{"type":"button","code":"button-5088233573574668","eventlist":[{"trigger":"onclicked","handler":"1255669515019227234"}],"name":"","text":"添加产品","displaytype":"default","marginright":"9","color":"white","bgcolor":"orange","flex":"1","marginleft":"9","height":"42","fontsize":"16","alignself":"","bgstyle":"round","marginbottom":"","margintop":"5","icon":"add"}]}]},{"type":"table","code":"table-8422996648725329","eventlist":[{"trigger":"onload","handler":"1255742610920837213"},{"trigger":"onrefresh","handler":""}],"name":"distribution_form","pageable":"0","checkable":"0","isradio":"0","sortable":"0","hiddenheader":"0","refreshable":"0","editable":"0","indexable":"0","freezecol":"1","personalizable":"0","crosspagecheckable":"0","resizable":"0","optimize":"0","flex":"1","mergeablecol":"","flexdirection":"horizontal","flexgrow":"1","flexshrink":"","height":"","rows":{"type":"row","code":"row-table-row","eventlist":[],"flex":"1","width":"","height":"","linenumber":"","content":[],"columnitems":[{"type":"text","code":"text-4348649839209722","eventlist":[],"name":"productname","linenumber":"","value":"文字","title":"产品名称","flex":"","fixed":"1","textalign":"center","width":"80"},{"type":"textinput","code":"textinput-0238899029843470","eventlist":[{"trigger":"onvaluechange","handler":"1320969637189521505"}],"name":"thistime_distribution","titlewidth":"110","titleflex":"","title":"本次排面","placeholder":"请输入","verificationrule":"","width":"50"},{"type":"text","code":"text-5313110246721713","eventlist":[],"name":"thistime_distribution1","linenumber":"","value":"文字","title":"thistime_distribution1(传参用)","hidden":"1"},{"type":"text","code":"text-3058188666086543","eventlist":[],"name":"productid","linenumber":"","value":"文字","title":"productid","flex":"1","hidden":"1"},{"type":"text","code":"text-6936289804603330","eventlist":[],"name":"storeid","linenumber":"","value":"","title":"storeid","hidden":"1"},{"type":"text","code":"text-7782183344632777","eventlist":[],"name":"is_thistime_distribution","linenumber":"","value":"","title":"本次排面情况","flex":"","textalign":"center","width":"50","hidden":"1"},{"type":"text","code":"text-0706534911440936","eventlist":[],"name":"lasttime_distribution","linenumber":"","value":"","title":"上次排面","flex":"","textalign":"center","width":"40"},{"type":"text","code":"text-7202444418154417","eventlist":[],"name":"is_lasttime_distribution","linenumber":"","value":"","title":"上次排面情况","flex":"","textalign":"center","width":"50","hidden":"1"},{"type":"number","code":"number-text-7125093237099577","eventlist":[],"name":"retail_price","linenumber":"","value":"","title":"零售价","flex":"","textalign":"center","width":"50"},{"type":"number","code":"number-text-3504741413415685","eventlist":[],"name":"promotion_price","linenumber":"","value":"","title":"促销价","flex":"","textalign":"center","width":"50"},{"type":"number","code":"number-text-4328209407595750","eventlist":[{"trigger":"onvaluechange","handler":"1320969637189521505"}],"name":"inventory","linenumber":"","value":"","title":"库存","flex":"","textalign":"center","width":"60","decimaldigits":"0","placeholder":"请输入"},{"type":"text","code":"text-5953871496332828","eventlist":[],"linenumber":"","name":"inventory1","value":"文字","title":"inventory1","hidden":"1"},{"type":"text","code":"text-5315139814416049","eventlist":[],"name":"unit","linenumber":"","value":"单位","title":"单位","width":"30"},{"type":"number","code":"number-text-1394382891321463","eventlist":[],"name":"interim_product_red","linenumber":"","value":"","title":"红色临期/箱","decimaldigits":"0","width":"60","placeholder":"请输入"},{"type":"number","code":"number-text-0972849742922927","eventlist":[],"name":"interim_product_yellow","linenumber":"","value":"","title":"黄色临期/箱","decimaldigits":"0","width":"60","placeholder":"请输入"},{"type":"checkbutton","code":"checkbutton-1045882591950016","eventlist":[],"name":"is_pricetag_good","titlewidth":"110","titleflex":"","title":"价签是否完整","placeholder":"","text":"","value":"","checkvalue":"1","uncheckvalue":"0","width":"50"},{"type":"checkbutton","code":"checkbutton-6543346580246328","eventlist":[],"name":"is_goldpositon","titlewidth":"110","titleflex":"","title":"是否黄金位置","placeholder":"","text":"","value":"","checkvalue":"1","uncheckvalue":"0","width":"50"},{"type":"button","code":"button-4962656838207291","eventlist":[{"trigger":"onclicked","handler":"1317390371487092834"}],"name":"","text":"删除","displaytype":"","title":"删除","height":"","width":"40","icon":"","bgstyle":"rectangle","bordervisible":"1","fontweight":"bold","bgcolor":"darkred","color":"white"}]},"statisticsrow":[]},{"type":"button","code":"button-5088233573574668","eventlist":[{"trigger":"onclicked","handler":"1255669515019227234"}],"name":"","text":"添加产品","displaytype":"default","marginright":"9","color":"white","bgcolor":"orange","flex":"","marginleft":"9","height":"42","fontsize":"16","alignself":"","bgstyle":"round","marginbottom":"","margintop":"18","hidden":"1"}]},"menu":[{"type":"button","code":"button-6150118669546005","eventlist":[{"trigger":"onclicked","handler":"1258661837461917791"}],"name":"","text":"铺货要求","displaytype":"default","functioncode":"1258661837461917794","color":"lightblack","bgColor":"white","fontSize":"5"}],"subviews":[]},"presenter":{"initial":[{"code":"initial_receivelink_event","actions":[{"code":"initial_recivelink_action","param":{"name":"__linkparam","datatype":"0","ctrlcode":"","properties":[{"name":"__pagestatus","paramtype":"1","ctrl":{"code":"","component":""}},{"name":"id","label":"","paramtype":"2","ctrl":{"code":"textinput-9214135724336418","component":""}},{"name":"seleareaid","alias":"saleareaid","label":"","paramtype":"2","ctrl":{"code":"","component":""}},{"name":"customercode","paramtype":"3","ctrl":{"code":"","component":""}},{"name":"customertype","paramtype":"3","ctrl":{"code":"","component":""}},{"name":"recordid","paramtype":"3","ctrl":{"code":"","component":""}},{"name":"visitcontentid","paramtype":"3","ctrl":{"code":"","component":""}},{"name":"collectionid","paramtype":"3","ctrl":{"code":"","component":""}},{"name":"storename","paramtype":"3","ctrl":{"code":"","component":""}}]},"type":"receivelink","desc":"参数接收","condition":""},{"condition":"fly:return Page.getValue('__pagestatus') == '3';","code":"1128573737680113759","desc":"提交按钮隐藏","type":"flycode","script":"fly:Page.getCtrl('提交按钮').hidden = true;"}],"desc":"页面初始-参数接收","successhint":"","condition":"","key":"","name":""}],"interface":[{"code":"1262575457312837728","desc":"铺货产品列表查询","successhint":"","key":"mypuhuo","name":"","condition":"","remark":"","actions":[{"condition":"","type":"eventlink","code":"1262575457312837729","desc":"事件监听","handler":"","param":{"name":"playproductObj","datatype":"1","ctrlcode":"","properties":[]}},{"type":"flycode","desc":"flycode","script":"fly:\nvar IN = IN;\nvar newbrandArr = Page.getValue('playproductObj');\n//Page.alert('newbrandArr',JSON.stringify(newbrandArr));\n//var arrayCtrl = new Array();\n//var arrayCtrl = Page.getArrayCtrl('distribution_form').getCheckedRows();\nvar arrayCtrl = Page.getArrayCtrl('distribution_form').getData();\n//Page.alert('arrayCtrl',JSON.stringify(arrayCtrl));\nvar all_rows = newbrandArr;\narrayCtrl.forEach(function(item, i) {\n  var isAdd = true;\n  newbrandArr.forEach(function(item2, j) {\n    if (item.productid === item2.productid) {\n      isAdd = false;\n    };\n  });\n  if (isAdd) {\n    all_rows.push(item);\n  };\n});\nvar setter = ArrayCtrlSetter();\nsetter.append('productname','productname');\nsetter.append('productid','productid');\nsetter.append('retail_price','retail_price');\nsetter.append('promotion_price','promotion_price');\nsetter.append('unit','unit');\nsetter.append('thistime_distribution1','thistime_distribution');\nsetter.append('inventory1','inventory');\n//Page.alert('all_rows',JSON.stringify(all_rows));\n Page.getArrayCtrl('distribution_form').updateList(all_rows, setter)\n","condition":"","code":"1317411916578164835"}]}],"handlers":[{"code":"1126440265700216928","desc":"绑定品牌","successhint":"","condition":"","key":"","name":"","actions":[{"condition":"","type":"datarequest","code":"1183584460487135331","desc":"数据字典绑定","logiccode":"100000000001100001","mode":"2","_type_spe":"dictbind","getter":[{"name":"pl_dictionary","datatype":"0","ctrl":{"code":"","scope":""},"properties":[{"name":"dictionarycode","value":"893288512944738381","ctrl":{"code":"","component":""}},{"name":"code","value":"","ctrl":{"code":"","component":""}},{"name":"parentdickey","value":"","ctrl":{"code":"","component":""}},{"name":"level","value":"","ctrl":{"code":"","component":""}},{"name":"status","value":"1","ctrl":{"code":"","component":""}},{"name":"objectmark","value":"kx_productbrand","ctrl":{"code":"","component":""}}]}],"setter":[{"name":"pl_dictionary","datatype":"1","ctrlcode":"dropdownbox-7594583300503574","properties":[{"name":"dickey","ctrl":{"code":"","component":"key"}},{"name":"dicvalue","ctrl":{"code":"","component":"text"}},{"name":"dictionaryid","ctrl":{"code":"","component":"id"}},{"name":"parentdictionaryid","ctrl":{"code":"","component":"parentid"}},{"name":"keypath","ctrl":{"code":"","component":"keypath"}}]}]}],"remark":""},{"code":"1126440265700216926","desc":"绑定品类","successhint":"","condition":"","key":"","name":"","actions":[{"condition":"","type":"datarequest","code":"1126440265700216927","desc":"数据字典绑定","logiccode":"100000000001100001","mode":"2","_type_spe":"dictbind","getter":[{"name":"pl_dictionary","datatype":"0","ctrl":{"code":"","scope":""},"properties":[{"name":"dictionarycode","value":"893288512944738380","ctrl":{"code":"","component":""}},{"name":"code","value":"","ctrl":{"code":"","component":""}},{"name":"parentdickey","value":"","ctrl":{"code":"","component":""}},{"name":"level","value":"","ctrl":{"code":"","component":""}},{"name":"status","value":"1","ctrl":{"code":"","component":""}},{"name":"objectmark","value":"kx_productcategory","ctrl":{"code":"","component":""}}]}],"setter":[{"name":"pl_dictionary","datatype":"1","ctrlcode":"dropdownbox-4607433631252034","properties":[{"name":"dickey","ctrl":{"code":"","component":"key"}},{"name":"dicvalue","ctrl":{"code":"","component":"text"}},{"name":"dictionaryid","ctrl":{"code":"","component":"id"}},{"name":"parentdictionaryid","ctrl":{"code":"","component":"parentid"}},{"name":"keypath","ctrl":{"code":"","component":"keypath"}}]}]}]},{"code":"1126440265700216922","desc":"表格缓存搜索","successhint":"","condition":"","key":"","name":"","actions":[{"type":"cachedatarequest","code":"1126440265700216923","containerctrlcode":"","conditions":{"ctrlcode":"filter-1934032382219387","properties":[[{"name":"productname","value":"","comparison":"contain","ctrl":{"code":"textinput-2854744284372358","component":""}}],[{"name":"barcode","value":"","comparison":"equal","ctrl":{"code":"ctrl_scan_key2","component":""}}],[{"name":"productbrand__namepath","value":"","comparison":"contain","ctrl":{"code":"dropdownbox-7594583300503574","component":"text"}}],[{"name":"productcategory__namepath","value":"","comparison":"contain","ctrl":{"code":"dropdownbox-4607433631252034","component":"text"}}],[{"name":"productseries__namepath","value":"","comparison":"contain","ctrl":{"code":"dropdownbox-9613182724735345","component":"text"}}],[{"name":"__ismodified","value":"","comparison":"equal","ctrl":{"code":"checkbutton-0562574052574536","component":""}}]]},"desc":"","relaterequestcode":"","condition":""},{"condition":"fly:return (Page.getCtrl('扫描').value != '' && Page.getCtrl('扫描').value != null);","code":"1128573737680113758","desc":"强制扫码勾选","type":"flycode","script":"fly:var scan = Page.getCtrl('扫描').value;\n//Page.alert('info', String(scan))\n// 苹果里面是数组JSON字符串\nif(scan[0] == '['){\n  try{\n    scan = JSON.parse(scan)[0]\n  }\n  catch(e){\n\n  }\n}\n//Page.alert('info', String(scan))\nif(scan != null && scan != '') {\n  var allRows = Page.getArrayCtrl('表格').getAllRows();\n\tfor(var i = 0; i < allRows.length; i++) {\n\t\tvar row = allRows[i];\n    // Page.alert('info', String(row.getValue('barcode')))\n  \tif(row.getValue('barcode') == scan) {\n     \trow.getCtrl('是否售卖').value = '1';\n      row.getCtrl('是否售卖').readonly =false;\n  \t}\n\t}\n}\n"},{"condition":"","code":"1185412367132004451","desc":"强制拍照勾选","type":"flycode","script":"fly:var scan = Page.getCtrl('拍照').value;\nif(scan != null && scan != '') {\n  var allRows = Page.getArrayCtrl('表格').getAllRows();\n\tfor(var i = 0; i < allRows.length; i++) {\n\t\tvar row = allRows[i];\n  \tif(row.getValue('barcode') == scan) {\n     \trow.getCtrl('是否售卖').value = '1';\n      row.getCtrl('是否售卖').readonly =false;\n  \t}\n\t}\n}"}],"remark":""},{"code":"1128208311955624034","desc":"提交铺货检查","successhint":"","key":"","name":"","condition":"","remark":"","actions":[{"condition":"","code":"1143061559489204323","desc":"flycode","type":"flycode","script":"fly: var tablelist = Page.getArrayCtrl('distribution_form').getAllRows();\n\n\nvar dtlist = new Array();\nvar fileInfos = [];\nvar flag = false;\nif (tablelist.length > 0) {\n\tfor (var i = 0; i < tablelist.length; i++) {\n\t\tvar row = tablelist[i];\n    \t//产品id\n\t\tvar productid = row.getValue('productid');\n    \t//本次排面\n\t\tvar thistime_distribution = row.getCtrl('thistime_distribution').value;\n    //上次排面\n\t\tvar lasttime_distribution = row.getCtrl('lasttime_distribution').value;\n    if(!thistime_distribution){\n       flag = true;\n    }\n    \t//是否黄金位置\n\t\tvar is_goldpositon = row.getCtrl('is_goldpositon').value;\n    \t//价签是否完整\n\t\tvar is_pricetag_good = row.getCtrl('is_pricetag_good').value;\n    \t//零售价\n\t\tvar retail_price = row.getCtrl('retail_price').value;\n    \t//单位\n\t\tvar unit = row.getCtrl('unit').value;\n    \n     if(retail_price > 20 && unit =='盒'){\n     throw new ERROR('单支零售价不能超过20，请重新填写' );\n    } else if(retail_price > 150){\n      throw new ERROR('零售价不能超过150，请重新填写' );\n              }\n    \t//促销价\n\t\tvar promotion_price = row.getCtrl('promotion_price').value;\n    \t//库存\n\t\tvar inventory = row.getCtrl('inventory').value;\n    //黄色预警\n\t\tvar interim_product_yellow = row.getCtrl('interim_product_yellow').value;\n     //红色预警\n\t\tvar interim_product_red = row.getCtrl('interim_product_red').value;\n\t\t/*//是否强制扫码\n\t\tvar isforcescan = row.getValue('isforcescan');\n\t\t//是否强制拍照\n\t\tvar isforcephoto = row.getValue('isforcephoto');\n\n\t\t//是否售卖\n\t\tvar salestatus = row.getCtrl('是否售卖').value;\n\n\t\t//拍照\n\t\tvar photo = row.getCtrl('拍照');\n\t\n\t\t//产品名称\n\t\tvar productname = row.getCtrl('产品名称').value;\n\t\t//原因\n\t\tvar reasons = row.getCtrl('原因').value;\n\n\t\t//产品组编码\n\t\tvar tn_code = row.getCtrl('产品组编码').value;*/\n\n    /*\n\t\tif (isforcescan == '1') {\n\t\t\tif (salestatus != '1') {\n\t\t\t\tif (reasons == null || reasons == '') {\n\t\t\t\t\tPage.alert(AlertType.info, productname + '请填写原因');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n  \n\t\tif (isforcephoto == '1' && salestatus == '1') {\n\t\t\tif (photo.getValue() == null || photo.getValue() == '') {\n\t\t\t\tPage.alert(AlertType.info, productname + '请拍照');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tvar fileInfo = photo.getValue(CtrlValueGetter('fileInfo'));\n\t\tif (fileInfo != null && fileInfo.length > 0) {\n\t\t\tif (typeof(fileInfo) == 'string') {\n\t\t\t\tvar json = eval('(' + fileInfo + ')');\n\t\t\t\tfor (var j = 0; j < json.length; j++) {\n\t\t\t\t\tfileInfos.push(json[j]);\n\t\t\t\t}\n\t\t\t} else if (Array.isArray(fileInfo) == true) {\n\t\t\t\tfor (var j = 0; j < fileInfo.length; j++) {\n\t\t\t\t\tfileInfos.push(fileInfo[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}  */\n\t\tvar dt = {\n\t\t\t\n\t\t\t'productid': productid,\n      'thistime_distribution': thistime_distribution,\n      'lasttime_distribution': lasttime_distribution,\n      'is_goldpositon': is_goldpositon,\n      's_pricetag_good': is_pricetag_good,\n      'retail_price': retail_price,\n      'promotion_price': promotion_price,\n      'inventory': inventory,\n      'interim_product_red': interim_product_red,\n      'interim_product_yellow': interim_product_yellow\n\t\t\t\n\n\t\t}\n\t\tdtlist.push(dt);\n\t}\n\nif(!flag){\n\tvar postData = {\n\t\t'kx_parameters': {\n\t\t\t'customerstatusid': System.uniqueid(),\n\t\t\t'visitactualid': System.uniqueid(),\n\t\t\t'workrecordid': System.uniqueid(),\n\t\t\t'submit_time': System.date().toString()\n\t\t},\n\t\t'kx_shopgoods_prod_insp': {\n\t\t\t'customerid': Page.getCtrl('storeid').value,\n\t\t\t'memberid': System.user().mbCode\n\n\t\t},\n\t\t'kx_shopgoods_prod_insp_dt': dtlist,\n\t\t'__visitworkparams': VisitWork.currentStepSubmitParam()\n\n\t};\n\n\tvar success = function(output) {\n\t\tModel.submitQueueData('终端拜访铺市检查保存', '终端拜访铺市检查保存', postData, fileInfos, null, null, null);\n\t};\n\n\tvar fail = function(errorCode, msg) {\n\t\tPage.alert(AlertType.error, msg != null ? msg : '数据上传失败');\n\t};\n\n\tvar completion = function(result, output, msg) {\n\t\tPage.closeProgress();\n\t\tPage.callEvent('refreshRecordOfflineData');\n    Page.callEvent('visitworkrefreshlist', null);\n\t\tVisitWork.gotoNextStep();\n\n\t};\n\tPage.openProgress('数据上传中...');\n\tModel.runLogicScript('终端拜访铺市检查保存', postData, success, fail, completion);\n}else{\n  Page.alert(AlertType.info, '本次排面数量不能为空')\n}\n} else {\n\tPage.alert(AlertType.info, '提交数据不能为空')\n\n}"},{"condition":"","type":"offlinemodelrequest","code":"1128272034300825693","desc":"离线数据更新请求","modelnames":["拜访工作记录离线模型"]},{"code":"call_visitworkrefreshlist_action","desc":"刷新列表","type":"call","pagecode":"","key":"visitworkrefreshlist","condition":""}]},{"condition":"","code":"skip_work_content","name":"","successhint":"","actions":[{"mode":"2","condition":"","code":"handler_submitdetail_action","getter":[{"datatype":"0","ctrl":{"code":"","scope":""},"name":"kx_parameters","properties":[{"ctrl":{"component":"","code":""},"name":"submitter","value":"le:user('mbcode')"},{"ctrl":{"component":"","code":""},"name":"submittername","value":"le:user('userinfoname')"},{"ctrl":{"component":"","code":"textinput-9214135724336418"},"name":"customerid","value":""},{"ctrl":{"component":"","code":""},"name":"submittertime","value":"le:date()"},{"ctrl":{"component":"","code":""},"name":"skipreason","value":""},{"ctrl":{"component":"","code":""},"name":"customertype","value":""},{"ctrl":{"component":"","code":""},"name":"customerstatusid","value":"le:uniqueid()"},{"ctrl":{"component":"","code":""},"name":"workrecordid","value":"le:uniqueid()"}]}],"logiccode":"1103924630269333588","type":"visitworkdatasubmit","setter":[],"queue":"0","desc":"保存-提交-跳过原因"}],"key":"","desc":"提交保存跳过原因","notice":""},{"code":"1255669515019227234","desc":"链接添加产品列表","successhint":"","key":"","name":"","condition":"","remark":"","actions":[{"type":"flycode","desc":"flycode","script":"//var arrayCtrl = Page.getArrayCtrl('distribution_form').getData();\n//var arrayCtrl = Page.getArrayCtrl('distribution_form').getInScope(\"all\");\n//Page.alert('arrayCtrl',JSON.stringify(arrayCtrl));","condition":"","code":"1320969637189521507"},{"condition":"","code":"1255669515019227235","desc":"链接添加产品列表","type":"flycode","script":"var table = Page.getArrayCtrl('distribution_form');\nvar tablist = table.getAllRows();\n\talldata=[];\n  var rows=table.getAllRows();\n  rows.forEach(function(item){\n  \tvar obj={};\n    obj.productid=item.getCtrl('productid').value;\n    obj.productname=item.getCtrl('productname').value;\n    alldata.push(obj);\n  })\n//Page.alert(AlertType.info, Page.getValue('id'));\nPage.linkToPage('铺货添加产品列表查询',{'id':Page.getValue('id'),'storeid':Page.getCtrl('storeid').value,'alldata':alldata})"}]},{"code":"1255742610920837213","desc":"铺货产品列表查询请求","successhint":"","key":"plistid","name":"","condition":"","remark":"","actions":[{"condition":"","type":"datarequest","code":"1255742610920837214","desc":"数据请求","pagesize":"","logiccode":"1255742610920837219","mode":"2","getter":[{"name":"kx_kq_product","datatype":"0","ctrl":{"code":"","scope":""},"properties":[{"name":"productname","value":"","ctrl":{"code":"","component":""}},{"name":"productbrand","value":"","ctrl":{"code":"dropdownbox-7594583300503574","component":"key"}},{"name":"productcategory","value":"","ctrl":{"code":"dropdownbox-4607433631252034","component":"key"}},{"name":"storeid","value":"","ctrl":{"code":"textinput-9214135724336418","component":""}}]}],"setter":[{"name":"tn_customer_addproduct","datatype":"1","ctrlcode":"table-8422996648725329","properties":[{"name":"id","alias":"","ctrl":{"code":"","component":""}},{"name":"productid","alias":"","ctrl":{"code":"text-3058188666086543","component":""}},{"name":"productname","alias":"","ctrl":{"code":"text-4348649839209722","component":""}},{"name":"storeid","alias":"","ctrl":{"code":"text-6936289804603330","component":""}},{"name":"tn_createop","alias":"","ctrl":{"code":"","component":""}},{"name":"tn_updateop","alias":"","ctrl":{"code":"","component":""}},{"name":"createtime","alias":"","ctrl":{"code":"","component":""}},{"name":"updatetime","alias":"","ctrl":{"code":"","component":""}},{"name":"thistime_distribution","alias":"","ctrl":{"code":"number-text-0388837253410048","component":""}},{"name":"is_goldpositon","alias":"","ctrl":{"code":"checkbutton-6543346580246328","component":""}},{"name":"is_pricetag_good","alias":"","ctrl":{"code":"checkbutton-1045882591950016","component":""}},{"name":"retail_price","alias":"","ctrl":{"code":"number-text-7125093237099577","component":""}},{"name":"promotion_price","alias":"","ctrl":{"code":"number-text-3504741413415685","component":""}},{"name":"inventory","alias":"","ctrl":{"code":"number-text-4328209407595750","component":""}},{"name":"interim_product_yellow","alias":"","ctrl":{"code":"number-text-0972849742922927","component":""}},{"name":"interim_product_red","alias":"","ctrl":{"code":"number-text-1394382891321463","component":""}},{"name":"is_thistime_distribution","alias":"","ctrl":{"code":"text-7202444418154417","component":""}},{"name":"is_tlasttime_distribution","alias":"","ctrl":{"code":"text-7202444418154417","component":""}},{"name":"lasttime_distribution_num","alias":"","ctrl":{"code":"text-0706534911440936","component":""}},{"name":"classification","alias":"","ctrl":{"code":"text-5315139814416049","component":""}}]}],"lazyload":""},{"type":"flycode","desc":"flycode","script":"var rows = Page.getArrayCtrl('distribution_form').getAllRows();\n\nfor(var i=0;i<rows.length;i++){\n\tvar row = rows[i];\n\tvar thistime_distribution = row.getCtrl('thistime_distribution').value;\n  var retail_price = row.getCtrl('retail_price').value;\n  var promotion_price = row.getCtrl('promotion_price').value;\n  var inventory = row.getCtrl('inventory').value;\n  var interim_product_red = row.getCtrl('interim_product_red').value;\n  var interim_product_yellow = row.getCtrl('interim_product_yellow').value;\n\n  if(thistime_distribution == '0'){\n   row.getCtrl('thistime_distribution').value = ''; \n  }\n  if(retail_price == '0'){\n   row.getCtrl('retail_price').value = ''; \n  }\n    if(promotion_price == '0'){\n   row.getCtrl('promotion_price').value = ''; \n  }\n    if(inventory == '0'){\n   row.getCtrl('inventory').value = ''; \n  }\n    if(interim_product_red == '0'){\n   row.getCtrl('interim_product_red').value = ''; \n  }\n    if(interim_product_yellow == '0'){\n   row.getCtrl('interim_product_yellow').value = ''; \n  }\n  \n}\n\n\n\n\n","condition":"","code":"1305782084954099748"}]},{"code":"1258661837461917791","desc":"跳转到铺货要求","successhint":"","condition":"","key":"","name":"","actions":[{"condition":"","type":"link","code":"1258661837461917792","desc":"链接","pagecode":"1258661837461917795","mode":"push","title":"铺货要求","pagesize":{"width":"","height":""},"param":{"name":"__linkparam","datatype":"0","ctrl":{"code":"","scope":""},"properties":[{"name":"__pagestatus","value":"","paramtype":"1","ctrl":{"code":"","component":""}},{"name":"终端ID","value":"","paramtype":"3","ctrl":{"code":"textinput-9214135724336418","component":""}}]}}],"remark":""},{"code":"1268028465119105122","desc":"删除售卖产品","successhint":"","condition":"","key":"plistid","name":"","actions":[{"condition":"","type":"datasubmit","code":"1268028465119105123","desc":"删除售卖产品","logiccode":"1263393229705973859","queue":"1","mode":"2","getter":[{"name":"tn_customer_addproduct","datatype":"0","ctrl":{"code":"table-8422996648725329","scope":"focused"},"properties":[{"name":"productid","value":"","ctrl":{"code":"text-3058188666086543","component":""}},{"name":"storeid","value":"","ctrl":{"code":"text-6936289804603330","component":""}}]}],"setter":[]},{"condition":"","type":"eventlink","code":"1268028465119105121","desc":"事件监听","handler":"1255742610920837213","param":{"name":"__linkparam","datatype":"0","ctrlcode":"","properties":[{"name":"__pagestatus","paramtype":"1","ctrl":{"code":"","component":""}}]}}],"remark":""},{"code":"1268165773172543584","desc":"缓存数据搜索查询","successhint":"","condition":"","key":"","name":"","actions":[{"condition":"","type":"cachedatarequest","code":"1268165773172543585","desc":"缓存数据搜索","containerctrlcode":"table-8422996648725329","relaterequestcode":"1255742610920837213","conditions":{"name":"tn_customer_addproduct","datatype":"1","ctrlcode":"","properties":[[{"name":"productbrand","comparison":"contain","value":"","ctrl":{"code":"dropdownbox-7594583300503574","component":"key"}},{"name":"productcategory","comparison":"contain","value":"","ctrl":{"code":"dropdownbox-4607433631252034","component":"key"}}]]}}],"remark":""},{"code":"1317390371487092834","desc":"前端删除","successhint":"","key":"","name":"","condition":"","remark":"","actions":[{"type":"flycode","desc":"flycode","script":"Page.getArrayCtrl(\"distribution_form\").deleteInScope('focused');","condition":"","code":"1317390371487092835"}]},{"code":"1320969637189521505","desc":"本次排面传值到文本传参用","successhint":"","key":"","name":"","condition":"","remark":"","actions":[{"type":"flycode","desc":"flycode","script":"fly: var tablelist = Page.getArrayCtrl('distribution_form').getAllRows();\n\n\nvar dtlist = new Array();\nvar fileInfos = [];\nvar flag = false;\nif (tablelist.length > 0) {\n\tfor (var i = 0; i < tablelist.length; i++) {\n    var row = tablelist[i];\n\t\trow.getCtrl('thistime_distribution1').value = row.getCtrl('thistime_distribution').value;\n  \trow.getCtrl('inventory1').value = row.getCtrl('inventory').value;\n  }}","condition":"","code":"1320969637189521506"}]}]},"businessmodel":[{"modellogicname":"铺货产品列表查询","execmode":"1","status":1,"actiontype":"2","modelcode":"1254948087709962335","actioncategory":"1","usedatarule":"1","functionname":"","modellogiccode":"1255742610920837219","marktype":"2","input":[{"name":"kx_kq_product","objectcode":"893288512944738326","objectname":"产品","datatype":"0","marktype":"2","properties":[{"name":"productname","propertyname":"产品名称","propertytypecode":"2","objectcode":"893288512944738326","propertycode":"893288512944738323","marktype":"2"},{"name":"productbrand","propertyname":"产品品牌","propertytypecode":"10000000000","objectcode":"893288512944738326","propertycode":"893288512944738321","marktype":"2"},{"name":"productcategory","propertyname":"产品品类","propertytypecode":"10000000000","objectcode":"893288512944738326","propertycode":"893288512944738320","marktype":"2"},{"name":"storeid","propertyname":"终端id","propertytypecode":"6","objectcode":"","propertycode":"","marktype":"2"}]}],"output":[{"name":"tn_customer_addproduct","objectcode":"1255434024453804121","objectname":"客户添加售卖产品SKU表","datatype":"1","marktype":"2","properties":[{"name":"id","propertyname":"主键","propertytypecode":"1","objectcode":"1255434024453804121","propertycode":"1255434024453804120","marktype":"2"},{"name":"productid","propertyname":"产品id","propertytypecode":"6","objectcode":"1255434024453804121","propertycode":"1255434024453804119","marktype":"2"},{"name":"productname","propertyname":"产品名称","propertytypecode":"3","objectcode":"1255434024453804121","propertycode":"1255434024453804118","marktype":"2"},{"name":"storeid","propertyname":"终端ID","propertytypecode":"6","objectcode":"1255434024453804121","propertycode":"1255434024453804117","marktype":"2"},{"name":"tn_createop","propertyname":"创建人 ","propertytypecode":"6","objectcode":"1255434024453804121","propertycode":"1255434024453804116","marktype":"2"},{"name":"tn_updateop","propertyname":"修改人","propertytypecode":"6","objectcode":"1255434024453804121","propertycode":"1255434024453804115","marktype":"2"},{"name":"createtime","propertyname":"创建时间","propertytypecode":"7","objectcode":"1255434024453804121","propertycode":"1255434024453804114","marktype":"2"},{"name":"updatetime","propertyname":"修改时间","propertytypecode":"7","objectcode":"1255434024453804121","propertycode":"1255434024453804113","marktype":"2"},{"name":"thistime_distribution","propertyname":"本次铺面","propertytypecode":"5","objectcode":"1255434024453804121","propertycode":"1255434024453804112","marktype":"2"},{"name":"is_goldpositon","propertyname":"是否黄金位置","propertytypecode":"18","objectcode":"1255434024453804121","propertycode":"1255445549553946723","marktype":"2"},{"name":"is_pricetag_good","propertyname":"价签是否完整","propertytypecode":"18","objectcode":"1255434024453804121","propertycode":"1255445549553946722","marktype":"2"},{"name":"retail_price","propertyname":"零售价","propertytypecode":"10","objectcode":"1255434024453804121","propertycode":"1255445549553946721","marktype":"2"},{"name":"promotion_price","propertyname":"促销价","propertytypecode":"10","objectcode":"1255434024453804121","propertycode":"1255445549553946720","marktype":"2"},{"name":"inventory","propertyname":"库存","propertytypecode":"5","objectcode":"1255434024453804121","propertycode":"1255445549553946719","marktype":"2"},{"name":"interim_product_yellow","propertyname":"临期品（黄色临期/箱）","propertytypecode":"10","objectcode":"1255434024453804121","propertycode":"1262917659352240212","marktype":"2"},{"name":"interim_product_red","propertyname":"临期品（红色临期/箱）","propertytypecode":"10","objectcode":"1255434024453804121","propertycode":"1262917659352240211","marktype":"2"},{"name":"is_thistime_distribution","propertyname":"本次铺面情况","propertytypecode":"3","objectcode":"","propertycode":"","marktype":"2"},{"name":"is_tlasttime_distribution","propertyname":"上次铺面情况","propertytypecode":"3","objectcode":"","propertycode":"","marktype":"2"},{"name":"lasttime_distribution_num","propertyname":"上次铺面数量","propertytypecode":"3","objectcode":"","propertycode":"","marktype":"2"},{"name":"classification","propertyname":"单位","propertytypecode":"3","objectcode":"","propertycode":"","marktype":"2"}]}]}],"workstep":{"skipeventcode":"skip_work_content","submiteventcode":"1128208311955624034"},"renderinfo":{"_ide_edit_flag":"1"}}],"functions":[{"createtime":"2020-05-08 09:59:32.0","createaccountcode":0,"clientcategorycode":2,"metamodelcode":1253521029947592704,"functioncode":1258567453622014034,"metaobjectcode":1258567453622014034,"functionname":"铺市检查-页面","marktype":2,"functioncategory":2,"updatetime":"2020-10-27 21:22:24.0","updateaccountname":"梁洪铭","pagecode":1258567453622014034,"createaccountname":"梁洪铭","seq":1,"status":1,"updateaccountcode":0},{"functiondescr":"铺货要求","createtime":"2020-05-08 17:36:13.0","createaccountcode":0,"clientcategorycode":2,"directorytypecode":1099863944148947043,"metamodelcode":1253521029947592704,"functioncode":1258661837461917794,"metaobjectcode":1258661837461917793,"functionname":"铺货要求","marktype":2,"functioncategory":3,"updatetime":"2020-10-19 20:08:16.0","updateaccountname":"杨荣","pagecode":1258567453622014034,"createaccountname":"梁洪铭","seq":1,"status":1,"updateaccountcode":0}],"protocols":[{"protocol":"{\"pageinfo\":{\"marktype\":\"2\",\"status\":\"1\",\"clientcategorycode\":\"2\",\"pagetemplatecode\":\"201\",\"type\":\"62\",\"code\":\"1258567453622014034\",\"cache\":{\"enable\":\"1\",\"keys\":[\"id\"]},\"title\":\"铺市检查\",\"pagedescr\":\"终端拜访铺市检查\",\"directorytypecode\":\"1099863944148947043\",\"versionnum\":\"2.0\",\"eventlist\":[{\"trigger\":\"onload\",\"handler\":\"\"}],\"pagecode\":\"1258567453622014034\"},\"view\":{\"body\":{\"type\":\"layout\",\"code\":\"layout-4648563854039516\",\"eventlist\":[],\"display\":\"flex\",\"flexdirection\":\"vertical\",\"flex\":\"1\",\"bordersides\":\"\",\"content\":[{\"type\":\"textinput\",\"code\":\"textinput-9214135724336418\",\"eventlist\":[],\"name\":\"storeid\",\"titlewidth\":\"\",\"titleflex\":\"20%\",\"title\":\"终端ID\",\"placeholder\":\"\",\"verificationrule\":\"\",\"hidden\":\"1\",\"flex\":\"0\"},{\"type\":\"layout\",\"code\":\"layout-4134635004360676\",\"eventlist\":[],\"display\":\"flex\",\"flexdirection\":\"vertical\",\"flex\":\"\",\"content\":[{\"type\":\"layout\",\"code\":\"layout-9656859096910010\",\"eventlist\":[],\"display\":\"flex\",\"flexdirection\":\"horizontal\",\"flex\":\"\",\"bordersides\":\"\",\"content\":[{\"type\":\"dropdownbox\",\"code\":\"dropdownbox-7594583300503574\",\"eventlist\":[{\"trigger\":\"onload\",\"handler\":\"1126440265700216928\"},{\"trigger\":\"onvaluechange\",\"handler\":\"1255742610920837213\"}],\"name\":\"品牌\",\"titlewidth\":\"\",\"titleflex\":\"20%\",\"title\":\"\",\"placeholder\":\"品牌\",\"hiddenclearbtn\":\"0\",\"flex\":\"1\"},{\"type\":\"dropdownbox\",\"code\":\"dropdownbox-4607433631252034\",\"eventlist\":[{\"trigger\":\"onload\",\"handler\":\"1126440265700216926\"},{\"trigger\":\"onvaluechange\",\"handler\":\"1255742610920837213\"}],\"name\":\"品类\",\"titlewidth\":\"\",\"titleflex\":\"20%\",\"title\":\"\",\"placeholder\":\"品类\",\"hiddenclearbtn\":\"0\",\"flex\":\"1\"},{\"type\":\"button\",\"code\":\"button-5088233573574668\",\"eventlist\":[{\"trigger\":\"onclicked\",\"handler\":\"1255669515019227234\"}],\"name\":\"\",\"text\":\"添加产品\",\"displaytype\":\"default\",\"marginright\":\"9\",\"color\":\"white\",\"bgcolor\":\"orange\",\"flex\":\"1\",\"marginleft\":\"9\",\"height\":\"42\",\"fontsize\":\"16\",\"alignself\":\"\",\"bgstyle\":\"round\",\"marginbottom\":\"\",\"margintop\":\"5\",\"icon\":\"add\"}]}]},{\"type\":\"table\",\"code\":\"table-8422996648725329\",\"eventlist\":[{\"trigger\":\"onload\",\"handler\":\"1255742610920837213\"},{\"trigger\":\"onrefresh\",\"handler\":\"\"}],\"name\":\"distribution_form\",\"pageable\":\"0\",\"checkable\":\"0\",\"isradio\":\"0\",\"sortable\":\"0\",\"hiddenheader\":\"0\",\"refreshable\":\"0\",\"editable\":\"0\",\"indexable\":\"0\",\"freezecol\":\"1\",\"personalizable\":\"0\",\"crosspagecheckable\":\"0\",\"resizable\":\"0\",\"optimize\":\"0\",\"flex\":\"1\",\"mergeablecol\":\"\",\"flexdirection\":\"horizontal\",\"flexgrow\":\"1\",\"flexshrink\":\"\",\"height\":\"\",\"rows\":{\"type\":\"row\",\"code\":\"row-table-row\",\"eventlist\":[],\"flex\":\"1\",\"width\":\"\",\"height\":\"\",\"linenumber\":\"\",\"content\":[],\"columnitems\":[{\"type\":\"text\",\"code\":\"text-4348649839209722\",\"eventlist\":[],\"name\":\"productname\",\"linenumber\":\"\",\"value\":\"文字\",\"title\":\"产品名称\",\"flex\":\"\",\"fixed\":\"1\",\"textalign\":\"center\",\"width\":\"80\"},{\"type\":\"textinput\",\"code\":\"textinput-0238899029843470\",\"eventlist\":[{\"trigger\":\"onvaluechange\",\"handler\":\"1320969637189521505\"}],\"name\":\"thistime_distribution\",\"titlewidth\":\"110\",\"titleflex\":\"\",\"title\":\"本次排面\",\"placeholder\":\"请输入\",\"verificationrule\":\"\",\"width\":\"50\"},{\"type\":\"text\",\"code\":\"text-5313110246721713\",\"eventlist\":[],\"name\":\"thistime_distribution1\",\"linenumber\":\"\",\"value\":\"文字\",\"title\":\"thistime_distribution1(传参用)\",\"hidden\":\"1\"},{\"type\":\"text\",\"code\":\"text-3058188666086543\",\"eventlist\":[],\"name\":\"productid\",\"linenumber\":\"\",\"value\":\"文字\",\"title\":\"productid\",\"flex\":\"1\",\"hidden\":\"1\"},{\"type\":\"text\",\"code\":\"text-6936289804603330\",\"eventlist\":[],\"name\":\"storeid\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"storeid\",\"hidden\":\"1\"},{\"type\":\"text\",\"code\":\"text-7782183344632777\",\"eventlist\":[],\"name\":\"is_thistime_distribution\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"本次排面情况\",\"flex\":\"\",\"textalign\":\"center\",\"width\":\"50\",\"hidden\":\"1\"},{\"type\":\"text\",\"code\":\"text-0706534911440936\",\"eventlist\":[],\"name\":\"lasttime_distribution\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"上次排面\",\"flex\":\"\",\"textalign\":\"center\",\"width\":\"40\"},{\"type\":\"text\",\"code\":\"text-7202444418154417\",\"eventlist\":[],\"name\":\"is_lasttime_distribution\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"上次排面情况\",\"flex\":\"\",\"textalign\":\"center\",\"width\":\"50\",\"hidden\":\"1\"},{\"type\":\"number\",\"code\":\"number-text-7125093237099577\",\"eventlist\":[],\"name\":\"retail_price\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"零售价\",\"flex\":\"\",\"textalign\":\"center\",\"width\":\"50\"},{\"type\":\"number\",\"code\":\"number-text-3504741413415685\",\"eventlist\":[],\"name\":\"promotion_price\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"促销价\",\"flex\":\"\",\"textalign\":\"center\",\"width\":\"50\"},{\"type\":\"number\",\"code\":\"number-text-4328209407595750\",\"eventlist\":[{\"trigger\":\"onvaluechange\",\"handler\":\"1320969637189521505\"}],\"name\":\"inventory\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"库存\",\"flex\":\"\",\"textalign\":\"center\",\"width\":\"60\",\"decimaldigits\":\"0\",\"placeholder\":\"请输入\"},{\"type\":\"text\",\"code\":\"text-5953871496332828\",\"eventlist\":[],\"linenumber\":\"\",\"name\":\"inventory1\",\"value\":\"文字\",\"title\":\"inventory1\",\"hidden\":\"1\"},{\"type\":\"text\",\"code\":\"text-5315139814416049\",\"eventlist\":[],\"name\":\"unit\",\"linenumber\":\"\",\"value\":\"单位\",\"title\":\"单位\",\"width\":\"30\"},{\"type\":\"number\",\"code\":\"number-text-1394382891321463\",\"eventlist\":[],\"name\":\"interim_product_red\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"红色临期/箱\",\"decimaldigits\":\"0\",\"width\":\"60\",\"placeholder\":\"请输入\"},{\"type\":\"number\",\"code\":\"number-text-0972849742922927\",\"eventlist\":[],\"name\":\"interim_product_yellow\",\"linenumber\":\"\",\"value\":\"\",\"title\":\"黄色临期/箱\",\"decimaldigits\":\"0\",\"width\":\"60\",\"placeholder\":\"请输入\"},{\"type\":\"checkbutton\",\"code\":\"checkbutton-1045882591950016\",\"eventlist\":[],\"name\":\"is_pricetag_good\",\"titlewidth\":\"110\",\"titleflex\":\"\",\"title\":\"价签是否完整\",\"placeholder\":\"\",\"text\":\"\",\"value\":\"\",\"checkvalue\":\"1\",\"uncheckvalue\":\"0\",\"width\":\"50\"},{\"type\":\"checkbutton\",\"code\":\"checkbutton-6543346580246328\",\"eventlist\":[],\"name\":\"is_goldpositon\",\"titlewidth\":\"110\",\"titleflex\":\"\",\"title\":\"是否黄金位置\",\"placeholder\":\"\",\"text\":\"\",\"value\":\"\",\"checkvalue\":\"1\",\"uncheckvalue\":\"0\",\"width\":\"50\"},{\"type\":\"button\",\"code\":\"button-4962656838207291\",\"eventlist\":[{\"trigger\":\"onclicked\",\"handler\":\"1317390371487092834\"}],\"name\":\"\",\"text\":\"删除\",\"displaytype\":\"\",\"title\":\"删除\",\"height\":\"\",\"width\":\"40\",\"icon\":\"\",\"bgstyle\":\"rectangle\",\"bordervisible\":\"1\",\"fontweight\":\"bold\",\"bgcolor\":\"darkred\",\"color\":\"white\"}]},\"statisticsrow\":[]},{\"type\":\"button\",\"code\":\"button-5088233573574668\",\"eventlist\":[{\"trigger\":\"onclicked\",\"handler\":\"1255669515019227234\"}],\"name\":\"\",\"text\":\"添加产品\",\"displaytype\":\"default\",\"marginright\":\"9\",\"color\":\"white\",\"bgcolor\":\"orange\",\"flex\":\"\",\"marginleft\":\"9\",\"height\":\"42\",\"fontsize\":\"16\",\"alignself\":\"\",\"bgstyle\":\"round\",\"marginbottom\":\"\",\"margintop\":\"18\",\"hidden\":\"1\"}]},\"menu\":[{\"type\":\"button\",\"code\":\"button-6150118669546005\",\"eventlist\":[{\"trigger\":\"onclicked\",\"handler\":\"1258661837461917791\"}],\"name\":\"\",\"text\":\"铺货要求\",\"displaytype\":\"default\",\"functioncode\":\"1258661837461917794\",\"color\":\"lightblack\",\"bgColor\":\"white\",\"fontSize\":\"5\"}],\"subviews\":[]},\"presenter\":{\"initial\":[{\"code\":\"initial_receivelink_event\",\"actions\":[{\"code\":\"initial_recivelink_action\",\"param\":{\"name\":\"__linkparam\",\"datatype\":\"0\",\"ctrlcode\":\"\",\"properties\":[{\"name\":\"__pagestatus\",\"paramtype\":\"1\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"id\",\"label\":\"\",\"paramtype\":\"2\",\"ctrl\":{\"code\":\"textinput-9214135724336418\",\"component\":\"\"}},{\"name\":\"seleareaid\",\"alias\":\"saleareaid\",\"label\":\"\",\"paramtype\":\"2\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"customercode\",\"paramtype\":\"3\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"customertype\",\"paramtype\":\"3\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"recordid\",\"paramtype\":\"3\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"visitcontentid\",\"paramtype\":\"3\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"collectionid\",\"paramtype\":\"3\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"storename\",\"paramtype\":\"3\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}}]},\"type\":\"receivelink\",\"desc\":\"参数接收\",\"condition\":\"\"},{\"condition\":\"fly:return Page.getValue('__pagestatus') == '3';\",\"code\":\"1128573737680113759\",\"desc\":\"提交按钮隐藏\",\"type\":\"flycode\",\"script\":\"fly:Page.getCtrl('提交按钮').hidden = true;\"}],\"desc\":\"页面初始-参数接收\",\"successhint\":\"\",\"condition\":\"\",\"key\":\"\",\"name\":\"\"}],\"interface\":[{\"code\":\"1262575457312837728\",\"desc\":\"铺货产品列表查询\",\"successhint\":\"\",\"key\":\"mypuhuo\",\"name\":\"\",\"condition\":\"\",\"remark\":\"\",\"actions\":[{\"condition\":\"\",\"type\":\"eventlink\",\"code\":\"1262575457312837729\",\"desc\":\"事件监听\",\"handler\":\"\",\"param\":{\"name\":\"playproductObj\",\"datatype\":\"1\",\"ctrlcode\":\"\",\"properties\":[]}},{\"type\":\"flycode\",\"desc\":\"flycode\",\"script\":\"fly:\\nvar IN = IN;\\nvar newbrandArr = Page.getValue('playproductObj');\\n//Page.alert('newbrandArr',JSON.stringify(newbrandArr));\\n//var arrayCtrl = new Array();\\n//var arrayCtrl = Page.getArrayCtrl('distribution_form').getCheckedRows();\\nvar arrayCtrl = Page.getArrayCtrl('distribution_form').getData();\\n//Page.alert('arrayCtrl',JSON.stringify(arrayCtrl));\\nvar all_rows = newbrandArr;\\narrayCtrl.forEach(function(item, i) {\\n  var isAdd = true;\\n  newbrandArr.forEach(function(item2, j) {\\n    if (item.productid === item2.productid) {\\n      isAdd = false;\\n    };\\n  });\\n  if (isAdd) {\\n    all_rows.push(item);\\n  };\\n});\\nvar setter = ArrayCtrlSetter();\\nsetter.append('productname','productname');\\nsetter.append('productid','productid');\\nsetter.append('retail_price','retail_price');\\nsetter.append('promotion_price','promotion_price');\\nsetter.append('unit','unit');\\nsetter.append('thistime_distribution1','thistime_distribution');\\nsetter.append('inventory1','inventory');\\n//Page.alert('all_rows',JSON.stringify(all_rows));\\n Page.getArrayCtrl('distribution_form').updateList(all_rows, setter)\\n\",\"condition\":\"\",\"code\":\"1317411916578164835\"}]}],\"handlers\":[{\"code\":\"1126440265700216928\",\"desc\":\"绑定品牌\",\"successhint\":\"\",\"condition\":\"\",\"key\":\"\",\"name\":\"\",\"actions\":[{\"condition\":\"\",\"type\":\"datarequest\",\"code\":\"1183584460487135331\",\"desc\":\"数据字典绑定\",\"logiccode\":\"100000000001100001\",\"mode\":\"2\",\"_type_spe\":\"dictbind\",\"getter\":[{\"name\":\"pl_dictionary\",\"datatype\":\"0\",\"ctrl\":{\"code\":\"\",\"scope\":\"\"},\"properties\":[{\"name\":\"dictionarycode\",\"value\":\"893288512944738381\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"code\",\"value\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"parentdickey\",\"value\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"level\",\"value\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"status\",\"value\":\"1\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"objectmark\",\"value\":\"kx_productbrand\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}}]}],\"setter\":[{\"name\":\"pl_dictionary\",\"datatype\":\"1\",\"ctrlcode\":\"dropdownbox-7594583300503574\",\"properties\":[{\"name\":\"dickey\",\"ctrl\":{\"code\":\"\",\"component\":\"key\"}},{\"name\":\"dicvalue\",\"ctrl\":{\"code\":\"\",\"component\":\"text\"}},{\"name\":\"dictionaryid\",\"ctrl\":{\"code\":\"\",\"component\":\"id\"}},{\"name\":\"parentdictionaryid\",\"ctrl\":{\"code\":\"\",\"component\":\"parentid\"}},{\"name\":\"keypath\",\"ctrl\":{\"code\":\"\",\"component\":\"keypath\"}}]}]}],\"remark\":\"\"},{\"code\":\"1126440265700216926\",\"desc\":\"绑定品类\",\"successhint\":\"\",\"condition\":\"\",\"key\":\"\",\"name\":\"\",\"actions\":[{\"condition\":\"\",\"type\":\"datarequest\",\"code\":\"1126440265700216927\",\"desc\":\"数据字典绑定\",\"logiccode\":\"100000000001100001\",\"mode\":\"2\",\"_type_spe\":\"dictbind\",\"getter\":[{\"name\":\"pl_dictionary\",\"datatype\":\"0\",\"ctrl\":{\"code\":\"\",\"scope\":\"\"},\"properties\":[{\"name\":\"dictionarycode\",\"value\":\"893288512944738380\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"code\",\"value\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"parentdickey\",\"value\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"level\",\"value\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"status\",\"value\":\"1\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"objectmark\",\"value\":\"kx_productcategory\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}}]}],\"setter\":[{\"name\":\"pl_dictionary\",\"datatype\":\"1\",\"ctrlcode\":\"dropdownbox-4607433631252034\",\"properties\":[{\"name\":\"dickey\",\"ctrl\":{\"code\":\"\",\"component\":\"key\"}},{\"name\":\"dicvalue\",\"ctrl\":{\"code\":\"\",\"component\":\"text\"}},{\"name\":\"dictionaryid\",\"ctrl\":{\"code\":\"\",\"component\":\"id\"}},{\"name\":\"parentdictionaryid\",\"ctrl\":{\"code\":\"\",\"component\":\"parentid\"}},{\"name\":\"keypath\",\"ctrl\":{\"code\":\"\",\"component\":\"keypath\"}}]}]}]},{\"code\":\"1126440265700216922\",\"desc\":\"表格缓存搜索\",\"successhint\":\"\",\"condition\":\"\",\"key\":\"\",\"name\":\"\",\"actions\":[{\"type\":\"cachedatarequest\",\"code\":\"1126440265700216923\",\"containerctrlcode\":\"\",\"conditions\":{\"ctrlcode\":\"filter-1934032382219387\",\"properties\":[[{\"name\":\"productname\",\"value\":\"\",\"comparison\":\"contain\",\"ctrl\":{\"code\":\"textinput-2854744284372358\",\"component\":\"\"}}],[{\"name\":\"barcode\",\"value\":\"\",\"comparison\":\"equal\",\"ctrl\":{\"code\":\"ctrl_scan_key2\",\"component\":\"\"}}],[{\"name\":\"productbrand__namepath\",\"value\":\"\",\"comparison\":\"contain\",\"ctrl\":{\"code\":\"dropdownbox-7594583300503574\",\"component\":\"text\"}}],[{\"name\":\"productcategory__namepath\",\"value\":\"\",\"comparison\":\"contain\",\"ctrl\":{\"code\":\"dropdownbox-4607433631252034\",\"component\":\"text\"}}],[{\"name\":\"productseries__namepath\",\"value\":\"\",\"comparison\":\"contain\",\"ctrl\":{\"code\":\"dropdownbox-9613182724735345\",\"component\":\"text\"}}],[{\"name\":\"__ismodified\",\"value\":\"\",\"comparison\":\"equal\",\"ctrl\":{\"code\":\"checkbutton-0562574052574536\",\"component\":\"\"}}]]},\"desc\":\"\",\"relaterequestcode\":\"\",\"condition\":\"\"},{\"condition\":\"fly:return (Page.getCtrl('扫描').value != '' && Page.getCtrl('扫描').value != null);\",\"code\":\"1128573737680113758\",\"desc\":\"强制扫码勾选\",\"type\":\"flycode\",\"script\":\"fly:var scan = Page.getCtrl('扫描').value;\\n//Page.alert('info', String(scan))\\n// 苹果里面是数组JSON字符串\\nif(scan[0] == '['){\\n  try{\\n    scan = JSON.parse(scan)[0]\\n  }\\n  catch(e){\\n\\n  }\\n}\\n//Page.alert('info', String(scan))\\nif(scan != null && scan != '') {\\n  var allRows = Page.getArrayCtrl('表格').getAllRows();\\n\\tfor(var i = 0; i < allRows.length; i++) {\\n\\t\\tvar row = allRows[i];\\n    // Page.alert('info', String(row.getValue('barcode')))\\n  \\tif(row.getValue('barcode') == scan) {\\n     \\trow.getCtrl('是否售卖').value = '1';\\n      row.getCtrl('是否售卖').readonly =false;\\n  \\t}\\n\\t}\\n}\\n\"},{\"condition\":\"\",\"code\":\"1185412367132004451\",\"desc\":\"强制拍照勾选\",\"type\":\"flycode\",\"script\":\"fly:var scan = Page.getCtrl('拍照').value;\\nif(scan != null && scan != '') {\\n  var allRows = Page.getArrayCtrl('表格').getAllRows();\\n\\tfor(var i = 0; i < allRows.length; i++) {\\n\\t\\tvar row = allRows[i];\\n  \\tif(row.getValue('barcode') == scan) {\\n     \\trow.getCtrl('是否售卖').value = '1';\\n      row.getCtrl('是否售卖').readonly =false;\\n  \\t}\\n\\t}\\n}\"}],\"remark\":\"\"},{\"code\":\"1128208311955624034\",\"desc\":\"提交铺货检查\",\"successhint\":\"\",\"key\":\"\",\"name\":\"\",\"condition\":\"\",\"remark\":\"\",\"actions\":[{\"condition\":\"\",\"code\":\"1143061559489204323\",\"desc\":\"flycode\",\"type\":\"flycode\",\"script\":\"fly: var tablelist = Page.getArrayCtrl('distribution_form').getAllRows();\\n\\n\\nvar dtlist = new Array();\\nvar fileInfos = [];\\nvar flag = false;\\nif (tablelist.length > 0) {\\n\\tfor (var i = 0; i < tablelist.length; i++) {\\n\\t\\tvar row = tablelist[i];\\n    \\t//产品id\\n\\t\\tvar productid = row.getValue('productid');\\n    \\t//本次排面\\n\\t\\tvar thistime_distribution = row.getCtrl('thistime_distribution').value;\\n    //上次排面\\n\\t\\tvar lasttime_distribution = row.getCtrl('lasttime_distribution').value;\\n    if(!thistime_distribution){\\n       flag = true;\\n    }\\n    \\t//是否黄金位置\\n\\t\\tvar is_goldpositon = row.getCtrl('is_goldpositon').value;\\n    \\t//价签是否完整\\n\\t\\tvar is_pricetag_good = row.getCtrl('is_pricetag_good').value;\\n    \\t//零售价\\n\\t\\tvar retail_price = row.getCtrl('retail_price').value;\\n    \\t//单位\\n\\t\\tvar unit = row.getCtrl('unit').value;\\n    \\n     if(retail_price > 20 && unit =='盒'){\\n     throw new ERROR('单支零售价不能超过20，请重新填写' );\\n    } else if(retail_price > 150){\\n      throw new ERROR('零售价不能超过150，请重新填写' );\\n              }\\n    \\t//促销价\\n\\t\\tvar promotion_price = row.getCtrl('promotion_price').value;\\n    \\t//库存\\n\\t\\tvar inventory = row.getCtrl('inventory').value;\\n    //黄色预警\\n\\t\\tvar interim_product_yellow = row.getCtrl('interim_product_yellow').value;\\n     //红色预警\\n\\t\\tvar interim_product_red = row.getCtrl('interim_product_red').value;\\n\\t\\t/*//是否强制扫码\\n\\t\\tvar isforcescan = row.getValue('isforcescan');\\n\\t\\t//是否强制拍照\\n\\t\\tvar isforcephoto = row.getValue('isforcephoto');\\n\\n\\t\\t//是否售卖\\n\\t\\tvar salestatus = row.getCtrl('是否售卖').value;\\n\\n\\t\\t//拍照\\n\\t\\tvar photo = row.getCtrl('拍照');\\n\\t\\n\\t\\t//产品名称\\n\\t\\tvar productname = row.getCtrl('产品名称').value;\\n\\t\\t//原因\\n\\t\\tvar reasons = row.getCtrl('原因').value;\\n\\n\\t\\t//产品组编码\\n\\t\\tvar tn_code = row.getCtrl('产品组编码').value;*/\\n\\n    /*\\n\\t\\tif (isforcescan == '1') {\\n\\t\\t\\tif (salestatus != '1') {\\n\\t\\t\\t\\tif (reasons == null || reasons == '') {\\n\\t\\t\\t\\t\\tPage.alert(AlertType.info, productname + '请填写原因');\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n  \\n\\t\\tif (isforcephoto == '1' && salestatus == '1') {\\n\\t\\t\\tif (photo.getValue() == null || photo.getValue() == '') {\\n\\t\\t\\t\\tPage.alert(AlertType.info, productname + '请拍照');\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tvar fileInfo = photo.getValue(CtrlValueGetter('fileInfo'));\\n\\t\\tif (fileInfo != null && fileInfo.length > 0) {\\n\\t\\t\\tif (typeof(fileInfo) == 'string') {\\n\\t\\t\\t\\tvar json = eval('(' + fileInfo + ')');\\n\\t\\t\\t\\tfor (var j = 0; j < json.length; j++) {\\n\\t\\t\\t\\t\\tfileInfos.push(json[j]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t} else if (Array.isArray(fileInfo) == true) {\\n\\t\\t\\t\\tfor (var j = 0; j < fileInfo.length; j++) {\\n\\t\\t\\t\\t\\tfileInfos.push(fileInfo[j]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}  */\\n\\t\\tvar dt = {\\n\\t\\t\\t\\n\\t\\t\\t'productid': productid,\\n      'thistime_distribution': thistime_distribution,\\n      'lasttime_distribution': lasttime_distribution,\\n      'is_goldpositon': is_goldpositon,\\n      's_pricetag_good': is_pricetag_good,\\n      'retail_price': retail_price,\\n      'promotion_price': promotion_price,\\n      'inventory': inventory,\\n      'interim_product_red': interim_product_red,\\n      'interim_product_yellow': interim_product_yellow\\n\\t\\t\\t\\n\\n\\t\\t}\\n\\t\\tdtlist.push(dt);\\n\\t}\\n\\nif(!flag){\\n\\tvar postData = {\\n\\t\\t'kx_parameters': {\\n\\t\\t\\t'customerstatusid': System.uniqueid(),\\n\\t\\t\\t'visitactualid': System.uniqueid(),\\n\\t\\t\\t'workrecordid': System.uniqueid(),\\n\\t\\t\\t'submit_time': System.date().toString()\\n\\t\\t},\\n\\t\\t'kx_shopgoods_prod_insp': {\\n\\t\\t\\t'customerid': Page.getCtrl('storeid').value,\\n\\t\\t\\t'memberid': System.user().mbCode\\n\\n\\t\\t},\\n\\t\\t'kx_shopgoods_prod_insp_dt': dtlist,\\n\\t\\t'__visitworkparams': VisitWork.currentStepSubmitParam()\\n\\n\\t};\\n\\n\\tvar success = function(output) {\\n\\t\\tModel.submitQueueData('终端拜访铺市检查保存', '终端拜访铺市检查保存', postData, fileInfos, null, null, null);\\n\\t};\\n\\n\\tvar fail = function(errorCode, msg) {\\n\\t\\tPage.alert(AlertType.error, msg != null ? msg : '数据上传失败');\\n\\t};\\n\\n\\tvar completion = function(result, output, msg) {\\n\\t\\tPage.closeProgress();\\n\\t\\tPage.callEvent('refreshRecordOfflineData');\\n    Page.callEvent('visitworkrefreshlist', null);\\n\\t\\tVisitWork.gotoNextStep();\\n\\n\\t};\\n\\tPage.openProgress('数据上传中...');\\n\\tModel.runLogicScript('终端拜访铺市检查保存', postData, success, fail, completion);\\n}else{\\n  Page.alert(AlertType.info, '本次排面数量不能为空')\\n}\\n} else {\\n\\tPage.alert(AlertType.info, '提交数据不能为空')\\n\\n}\"},{\"condition\":\"\",\"type\":\"offlinemodelrequest\",\"code\":\"1128272034300825693\",\"desc\":\"离线数据更新请求\",\"modelnames\":[\"拜访工作记录离线模型\"]},{\"code\":\"call_visitworkrefreshlist_action\",\"desc\":\"刷新列表\",\"type\":\"call\",\"pagecode\":\"\",\"key\":\"visitworkrefreshlist\",\"condition\":\"\"}]},{\"condition\":\"\",\"code\":\"skip_work_content\",\"name\":\"\",\"successhint\":\"\",\"actions\":[{\"mode\":\"2\",\"condition\":\"\",\"code\":\"handler_submitdetail_action\",\"getter\":[{\"datatype\":\"0\",\"ctrl\":{\"code\":\"\",\"scope\":\"\"},\"name\":\"kx_parameters\",\"properties\":[{\"ctrl\":{\"component\":\"\",\"code\":\"\"},\"name\":\"submitter\",\"value\":\"le:user('mbcode')\"},{\"ctrl\":{\"component\":\"\",\"code\":\"\"},\"name\":\"submittername\",\"value\":\"le:user('userinfoname')\"},{\"ctrl\":{\"component\":\"\",\"code\":\"textinput-9214135724336418\"},\"name\":\"customerid\",\"value\":\"\"},{\"ctrl\":{\"component\":\"\",\"code\":\"\"},\"name\":\"submittertime\",\"value\":\"le:date()\"},{\"ctrl\":{\"component\":\"\",\"code\":\"\"},\"name\":\"skipreason\",\"value\":\"\"},{\"ctrl\":{\"component\":\"\",\"code\":\"\"},\"name\":\"customertype\",\"value\":\"\"},{\"ctrl\":{\"component\":\"\",\"code\":\"\"},\"name\":\"customerstatusid\",\"value\":\"le:uniqueid()\"},{\"ctrl\":{\"component\":\"\",\"code\":\"\"},\"name\":\"workrecordid\",\"value\":\"le:uniqueid()\"}]}],\"logiccode\":\"1103924630269333588\",\"type\":\"visitworkdatasubmit\",\"setter\":[],\"queue\":\"0\",\"desc\":\"保存-提交-跳过原因\"}],\"key\":\"\",\"desc\":\"提交保存跳过原因\",\"notice\":\"\"},{\"code\":\"1255669515019227234\",\"desc\":\"链接添加产品列表\",\"successhint\":\"\",\"key\":\"\",\"name\":\"\",\"condition\":\"\",\"remark\":\"\",\"actions\":[{\"type\":\"flycode\",\"desc\":\"flycode\",\"script\":\"//var arrayCtrl = Page.getArrayCtrl('distribution_form').getData();\\n//var arrayCtrl = Page.getArrayCtrl('distribution_form').getInScope(\\\"all\\\");\\n//Page.alert('arrayCtrl',JSON.stringify(arrayCtrl));\",\"condition\":\"\",\"code\":\"1320969637189521507\"},{\"condition\":\"\",\"code\":\"1255669515019227235\",\"desc\":\"链接添加产品列表\",\"type\":\"flycode\",\"script\":\"var table = Page.getArrayCtrl('distribution_form');\\nvar tablist = table.getAllRows();\\n\\talldata=[];\\n  var rows=table.getAllRows();\\n  rows.forEach(function(item){\\n  \\tvar obj={};\\n    obj.productid=item.getCtrl('productid').value;\\n    obj.productname=item.getCtrl('productname').value;\\n    alldata.push(obj);\\n  })\\n//Page.alert(AlertType.info, Page.getValue('id'));\\nPage.linkToPage('铺货添加产品列表查询',{'id':Page.getValue('id'),'storeid':Page.getCtrl('storeid').value,'alldata':alldata})\"}]},{\"code\":\"1255742610920837213\",\"desc\":\"铺货产品列表查询请求\",\"successhint\":\"\",\"key\":\"plistid\",\"name\":\"\",\"condition\":\"\",\"remark\":\"\",\"actions\":[{\"condition\":\"\",\"type\":\"datarequest\",\"code\":\"1255742610920837214\",\"desc\":\"数据请求\",\"pagesize\":\"\",\"logiccode\":\"1255742610920837219\",\"mode\":\"2\",\"getter\":[{\"name\":\"kx_kq_product\",\"datatype\":\"0\",\"ctrl\":{\"code\":\"\",\"scope\":\"\"},\"properties\":[{\"name\":\"productname\",\"value\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"productbrand\",\"value\":\"\",\"ctrl\":{\"code\":\"dropdownbox-7594583300503574\",\"component\":\"key\"}},{\"name\":\"productcategory\",\"value\":\"\",\"ctrl\":{\"code\":\"dropdownbox-4607433631252034\",\"component\":\"key\"}},{\"name\":\"storeid\",\"value\":\"\",\"ctrl\":{\"code\":\"textinput-9214135724336418\",\"component\":\"\"}}]}],\"setter\":[{\"name\":\"tn_customer_addproduct\",\"datatype\":\"1\",\"ctrlcode\":\"table-8422996648725329\",\"properties\":[{\"name\":\"id\",\"alias\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"productid\",\"alias\":\"\",\"ctrl\":{\"code\":\"text-3058188666086543\",\"component\":\"\"}},{\"name\":\"productname\",\"alias\":\"\",\"ctrl\":{\"code\":\"text-4348649839209722\",\"component\":\"\"}},{\"name\":\"storeid\",\"alias\":\"\",\"ctrl\":{\"code\":\"text-6936289804603330\",\"component\":\"\"}},{\"name\":\"tn_createop\",\"alias\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"tn_updateop\",\"alias\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"createtime\",\"alias\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"updatetime\",\"alias\":\"\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"thistime_distribution\",\"alias\":\"\",\"ctrl\":{\"code\":\"number-text-0388837253410048\",\"component\":\"\"}},{\"name\":\"is_goldpositon\",\"alias\":\"\",\"ctrl\":{\"code\":\"checkbutton-6543346580246328\",\"component\":\"\"}},{\"name\":\"is_pricetag_good\",\"alias\":\"\",\"ctrl\":{\"code\":\"checkbutton-1045882591950016\",\"component\":\"\"}},{\"name\":\"retail_price\",\"alias\":\"\",\"ctrl\":{\"code\":\"number-text-7125093237099577\",\"component\":\"\"}},{\"name\":\"promotion_price\",\"alias\":\"\",\"ctrl\":{\"code\":\"number-text-3504741413415685\",\"component\":\"\"}},{\"name\":\"inventory\",\"alias\":\"\",\"ctrl\":{\"code\":\"number-text-4328209407595750\",\"component\":\"\"}},{\"name\":\"interim_product_yellow\",\"alias\":\"\",\"ctrl\":{\"code\":\"number-text-0972849742922927\",\"component\":\"\"}},{\"name\":\"interim_product_red\",\"alias\":\"\",\"ctrl\":{\"code\":\"number-text-1394382891321463\",\"component\":\"\"}},{\"name\":\"is_thistime_distribution\",\"alias\":\"\",\"ctrl\":{\"code\":\"text-7202444418154417\",\"component\":\"\"}},{\"name\":\"is_tlasttime_distribution\",\"alias\":\"\",\"ctrl\":{\"code\":\"text-7202444418154417\",\"component\":\"\"}},{\"name\":\"lasttime_distribution_num\",\"alias\":\"\",\"ctrl\":{\"code\":\"text-0706534911440936\",\"component\":\"\"}},{\"name\":\"classification\",\"alias\":\"\",\"ctrl\":{\"code\":\"text-5315139814416049\",\"component\":\"\"}}]}],\"lazyload\":\"\"},{\"type\":\"flycode\",\"desc\":\"flycode\",\"script\":\"var rows = Page.getArrayCtrl('distribution_form').getAllRows();\\n\\nfor(var i=0;i<rows.length;i++){\\n\\tvar row = rows[i];\\n\\tvar thistime_distribution = row.getCtrl('thistime_distribution').value;\\n  var retail_price = row.getCtrl('retail_price').value;\\n  var promotion_price = row.getCtrl('promotion_price').value;\\n  var inventory = row.getCtrl('inventory').value;\\n  var interim_product_red = row.getCtrl('interim_product_red').value;\\n  var interim_product_yellow = row.getCtrl('interim_product_yellow').value;\\n\\n  if(thistime_distribution == '0'){\\n   row.getCtrl('thistime_distribution').value = ''; \\n  }\\n  if(retail_price == '0'){\\n   row.getCtrl('retail_price').value = ''; \\n  }\\n    if(promotion_price == '0'){\\n   row.getCtrl('promotion_price').value = ''; \\n  }\\n    if(inventory == '0'){\\n   row.getCtrl('inventory').value = ''; \\n  }\\n    if(interim_product_red == '0'){\\n   row.getCtrl('interim_product_red').value = ''; \\n  }\\n    if(interim_product_yellow == '0'){\\n   row.getCtrl('interim_product_yellow').value = ''; \\n  }\\n  \\n}\\n\\n\\n\\n\\n\",\"condition\":\"\",\"code\":\"1305782084954099748\"}]},{\"code\":\"1258661837461917791\",\"desc\":\"跳转到铺货要求\",\"successhint\":\"\",\"condition\":\"\",\"key\":\"\",\"name\":\"\",\"actions\":[{\"condition\":\"\",\"type\":\"link\",\"code\":\"1258661837461917792\",\"desc\":\"链接\",\"pagecode\":\"1258661837461917795\",\"mode\":\"push\",\"title\":\"铺货要求\",\"pagesize\":{\"width\":\"\",\"height\":\"\"},\"param\":{\"name\":\"__linkparam\",\"datatype\":\"0\",\"ctrl\":{\"code\":\"\",\"scope\":\"\"},\"properties\":[{\"name\":\"__pagestatus\",\"value\":\"\",\"paramtype\":\"1\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}},{\"name\":\"终端ID\",\"value\":\"\",\"paramtype\":\"3\",\"ctrl\":{\"code\":\"textinput-9214135724336418\",\"component\":\"\"}}]}}],\"remark\":\"\"},{\"code\":\"1268028465119105122\",\"desc\":\"删除售卖产品\",\"successhint\":\"\",\"condition\":\"\",\"key\":\"plistid\",\"name\":\"\",\"actions\":[{\"condition\":\"\",\"type\":\"datasubmit\",\"code\":\"1268028465119105123\",\"desc\":\"删除售卖产品\",\"logiccode\":\"1263393229705973859\",\"queue\":\"1\",\"mode\":\"2\",\"getter\":[{\"name\":\"tn_customer_addproduct\",\"datatype\":\"0\",\"ctrl\":{\"code\":\"table-8422996648725329\",\"scope\":\"focused\"},\"properties\":[{\"name\":\"productid\",\"value\":\"\",\"ctrl\":{\"code\":\"text-3058188666086543\",\"component\":\"\"}},{\"name\":\"storeid\",\"value\":\"\",\"ctrl\":{\"code\":\"text-6936289804603330\",\"component\":\"\"}}]}],\"setter\":[]},{\"condition\":\"\",\"type\":\"eventlink\",\"code\":\"1268028465119105121\",\"desc\":\"事件监听\",\"handler\":\"1255742610920837213\",\"param\":{\"name\":\"__linkparam\",\"datatype\":\"0\",\"ctrlcode\":\"\",\"properties\":[{\"name\":\"__pagestatus\",\"paramtype\":\"1\",\"ctrl\":{\"code\":\"\",\"component\":\"\"}}]}}],\"remark\":\"\"},{\"code\":\"1268165773172543584\",\"desc\":\"缓存数据搜索查询\",\"successhint\":\"\",\"condition\":\"\",\"key\":\"\",\"name\":\"\",\"actions\":[{\"condition\":\"\",\"type\":\"cachedatarequest\",\"code\":\"1268165773172543585\",\"desc\":\"缓存数据搜索\",\"containerctrlcode\":\"table-8422996648725329\",\"relaterequestcode\":\"1255742610920837213\",\"conditions\":{\"name\":\"tn_customer_addproduct\",\"datatype\":\"1\",\"ctrlcode\":\"\",\"properties\":[[{\"name\":\"productbrand\",\"comparison\":\"contain\",\"value\":\"\",\"ctrl\":{\"code\":\"dropdownbox-7594583300503574\",\"component\":\"key\"}},{\"name\":\"productcategory\",\"comparison\":\"contain\",\"value\":\"\",\"ctrl\":{\"code\":\"dropdownbox-4607433631252034\",\"component\":\"key\"}}]]}}],\"remark\":\"\"},{\"code\":\"1317390371487092834\",\"desc\":\"前端删除\",\"successhint\":\"\",\"key\":\"\",\"name\":\"\",\"condition\":\"\",\"remark\":\"\",\"actions\":[{\"type\":\"flycode\",\"desc\":\"flycode\",\"script\":\"Page.getArrayCtrl(\\\"distribution_form\\\").deleteInScope('focused');\",\"condition\":\"\",\"code\":\"1317390371487092835\"}]},{\"code\":\"1320969637189521505\",\"desc\":\"本次排面传值到文本传参用\",\"successhint\":\"\",\"key\":\"\",\"name\":\"\",\"condition\":\"\",\"remark\":\"\",\"actions\":[{\"type\":\"flycode\",\"desc\":\"flycode\",\"script\":\"fly: var tablelist = Page.getArrayCtrl('distribution_form').getAllRows();\\n\\n\\nvar dtlist = new Array();\\nvar fileInfos = [];\\nvar flag = false;\\nif (tablelist.length > 0) {\\n\\tfor (var i = 0; i < tablelist.length; i++) {\\n    var row = tablelist[i];\\n\\t\\trow.getCtrl('thistime_distribution1').value = row.getCtrl('thistime_distribution').value;\\n  \\trow.getCtrl('inventory1').value = row.getCtrl('inventory').value;\\n  }}\",\"condition\":\"\",\"code\":\"1320969637189521506\"}]}]},\"workstep\":{\"skipeventcode\":\"skip_work_content\",\"submiteventcode\":\"1128208311955624034\"},\"renderinfo\":{\"_ide_edit_flag\":\"1\"}}","pagecode":1258567453622014034}]}